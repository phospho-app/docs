---
title: User Feedback
description: How to send the user feedback from your app to phospho?
---

In your app, you likely collect feedback from your end-user. For example, as a rating (success/failure), free text (ex: a comment), or other interactions (copy to clipboard, etc.).

You can also log this end user feedback to phospho. This helps improve the quality of the scoring model.

The logged feedback is displayed in the webapp for you to review.

## What's the task id?

In your app, you likely collect user feedback **after** having logged a task to phospho. To link the user feedback to the log, phospho needs to know the **task_id**.

## How to log user feedback?

<Tabs>
<Tab title="Python" icon="python">

The phospho python package provides a `user_feedback` function to log user feedback.

```python
pip install phospho
```

phospho keeps tracks of the latest task id used. For simple use cases, you can do:

```python
phospho.user_feedback(
    task_id=phospho.latest_task_id,
    flag="success", # or "failure"
    flag_source="user",
    notes="Some notes (can be None)",
)
```

For more complex use cases, you can get the task_id from the `phospho.log`

```python
logged_content = phospho.log(input="question", output="answer")
task_id = logged_content["task_id"]

# ... later, when you collect feedback

phospho.user_feedback(
    task_id=task_id,
    flag="success",
)
```

You can also entirely manage the task_id yourself.

```python
# Generate a new task_id
task_id = phospho.new_task()

# Pass it to phospho.log to create a task with this id
phospho.log(input="question", output="answer", task_id=task_id)

# Give user feedback
phospho.user_feedback(
    task_id=task_id,
    flag="success"
)
```

</Tab>

<Tab title="Javascript/Typescript" icon="js">

The phospho javascript package provides a server-side `userFeedback` function and a client-side `sendUserFeedback` function to log user feedback.

```bash
npm install phospho
```

### Server-side (Node.js)

phospho keeps tracks of the latest task id used. 


```javascript
import {phospho} from "phospho";
phospho.userFeedback({
  tastId: phospho.latestTaskId,
  flag: "success", // or "failure"
  flagSource: "user",
  notes: "Some notes (can be None)",
});
```

For more complex use cases, you can get the task_id from the `phospho.log`. Beware ! The task_id is in snake_case.

```javascript
const loggedContent = await phospho.log({
  input: "question",
  output: "answer",
});
// Beware ! The task_id is in snake_case
const taskId = loggedContent.task_id;

// ... later, when you collect feedback
phospho.userFeedback({
  taskId: taskId,
  flag: "success",
});
```

You can also entirely manage the task_id yourself.

```javascript
// Generate a new task_id
const taskId = phospho.newTask();

// Pass it to phospho.log to create a task with this id
phospho.log({ input: "question", output: "answer", taskId: taskId });

// Give user feedback
phospho.userFeedback({
  taskId: taskId,
  flag: "success",
});
```

### Client-side (Browser)

If you collect user feedback in the browser, you can use the `sendUserFeedback` function. 

This function is different from the server side, because it doesn't need your phospho api key. This is done to avoid leaking your phospho API key.

However, this function requires the `projectId`.

Here is how to use the `sendUserFeedback` function. 

```javascript
import {sendUserFeedback} from "phospho";

// Handle logging in your backend, and send the task_id to the browser
const taskId = await fetch(
  "https://your-backend.com/some-endpoint",
  {
    method: "POST",
    headers: {
      "Content-Type": "application/json",
    },
    body: JSON.stringify({
      your: "stuff",
    }),
  }
).then((res) => res.json()).then((data) => data.task_id);

// When you collect feedback, send it to phospho
// For example, when the user clicks on a button
sendUserFeedback({
  projectId: "your_project_id",
  tastId: taskId,
  flag: "success", // or "failure"
  flagSource: "user",
  notes: "Some notes (can be None)",
});
```

</Tab>

<Tab title="API" icon="webhook">

If you are using the API directly, you need to manage the task_id by yourself.

Create a task_id by generating a random string hash. It needs to be unique for each task. 

```bash
TASK_ID=$(openssl rand -hex 32)
```

<Note>
Did you know? You have higher chances of winning the lottery than generating the same task_id twice.
</Note>

Pass this task_id to the `log` endpoint.

```bash
curl -X POST https://api.phospho.ai/v2/log/$PHOSPHO_PROJECT_ID \
-H "Authorization: Bearer $PHOSPHO_API_KEY" \
-H "Content-Type: application/json" \
-d '{
    "batched_log_events": [
        {
            "input": "your_input",
            "output": "your_output",
            "task_id": "$TASK_ID"
        }
    ]
}'
```

Give user feedback by updating the task associated to this id.

This endpoint is public. You shouldn't need to pass the API key, but you need to pass the project_id. This is done to avoid leaking your phospho API key.

```bash
curl -X POST https://api.phospho.ai/v2/tasks/$TASK_ID/ \
-H "Content-Type: application/json" \
-d '{
    "project_id": "$PHOSPHO_PROJECT_ID",
    "flag": "success",
    "flag_source": "user"
    "notes": "This is what the user said about this task"
}'
```

</Tab>
</Tabs>
